let deudores,sequel;_f42‍.x([["insertar_deudores",()=>insertar_deudores]]);_f42‍.w("../database/dao",[["deudores",["deudores"],function(v){deudores=v}]]);_f42‍.w("../database",[["sequel",["sequel"],function(v){sequel=v}]]);


       const insertar_deudores = async (req, res) => {
    console.log('SERVICE [insertar_deudores]')
    const { nombre_deudor } = req.body
    const transaction = await sequel.transaction()
    try {

        let deudor = nombre_deudor.toUpperCase()

        const valida_deudor = await deudores.valida_deudor(deudor)
        _f42‍.g.console.log('valida_deudor', valida_deudor)

        if (valida_deudor) {
            res.status(200).send({ message: 'Ya existe deudor ingresado' });
        }

        console.log('no existe deudor')
        await deudores.insertar_deudores(deudor, transaction)
        await transaction.commit()
        res.status(200).send({ message: process.env.MENSAJE_OK });

    } catch (e) {
        await transaction.rollback()
        _f42‍.g.console.log(e.message);
        res.status(500).send({ message: process.env.MENSAJE_NOK });
    }
}